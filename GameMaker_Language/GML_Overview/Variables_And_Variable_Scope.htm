<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../..",gTopicId="8.2.1.1"</script><script type="text/javascript" src="../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Variables And Variable Scope</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../assets/css/default.css" type="text/css"><script src="../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Page outlining variables and their scoping in GML"><meta name="rh-index-keywords" content="Variables And Variable Scope"><meta name="search-keywords" content="variables,scope,local variables,instance variables,global variables"><meta name="brsnext" value="GameMaker_Language/GML_Overview/Variables/Local_Variables.htm"><meta name="brsprev" value="GameMaker_Language/GML_Overview/Runtime_Functions.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="Variables And Variable Scope"><span>Variables And Variable Scope</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1><span data-field="title" data-format="default">变量和变量作用域</span></h1><p>变量是大多数编程操作的基本单位。与任何编程语言一样，<b>GML</b>使用它们。</p><p>它们用于将信息存储在设备内存中以供以后(或即时)使用，并指定名称，以便您可以在<a href="Runtime_Functions.htm">运行时</a>和<a href="Script_Functions.htm">脚本函数</a>中引用它们。</p><p><b>GML</b>中的变量可以存储许多不同的<a href="Data_Types.htm">数据类型</a>，例如实数(例如：<span class="inline2">100</span>、<span class="inline2">2.456575</span>、<span class="inline2">-56</span>等)、字符串(例如：<span class="inline2">"Hello world!"</span>)、整数(例如：<span class="inline2">1</span>、<span class="inline2">556</span>、<span class="inline2">-7</span>)或布尔值(<span class="inline2">true</span>或<span class="inline2">false</span>)，以及其他内容：</p><p class="code">var _num = 126.4545;<br>var _str = "Hello World";<br>new_num = _num * 100;<br>global.my_string = _str + " I said";</p><p>也可以使用变量保存从函数返回的值，例如：</p><p class="code">var _id = instance_nearest(x, y, obj_Tree);<br>root = sqrt(1000);<br>global.str = string_upper("Hello World");</p><p>因此，变量是我们可以命名并用于存储值以供以后在一个或多个操作中使用的东西。</p><p>一个很好的"真实的世界"变量的例子是某物的速度，例如：汽车的速度。汽车的速度显然是<em>可变的</em>，因为在某个时间点，汽车将静止不动(即其速度等于0)，在另一时间点汽车将行驶(即，其速度大于0)。当汽车加速或减速时，它的速度会改变。因此，如果您想在<span data-keyref="GameMaker Name">GameMaker</span>游戏中存储汽车的速度，则可以将其存储在<strong>变量</strong>中。在游戏中，你可以。当游戏开始时，将变量设置为0，并在您希望汽车改变其速度时更改它。</p><h2>Variable Assignment</h2><p>在 GML 中，与许多编程语言一样，您首先必须创建一个变量"赋值"，然后才能使用它。这基本上意味着您告诉计算机您希望用于变量的名称并为其分配初始值。然后，变量在内存中被赋予一个位置来存储值或对其执行操作。变量赋值采用以下形式：</p><p class="code">&lt;variable&gt; = &lt;expression&gt;;</p><p>表达式可以是一个简单的值，也可以是更复杂的值，因此，您可以使用<span class="inline2">+=</span>将值添加到变量的当前值，而不是给变量赋值，例如：</p><p class="code">a = 100;&nbsp;&nbsp;&nbsp;// Assigning a simple value<br>b = 200;<br>c = 300;<br>a += b;&nbsp;&nbsp;&nbsp;&nbsp;// Assigning with operation<br>a = b + c; // Assigning with expression</p><p class="note"><span class="note">注意</span>GameMaker 语言还将接受<span class="inline2">:=</span>进行分配，尽管这通常不是最常见的方法：</p><p class="code">&lt;variable&gt; := &lt;expression&gt;;</p><p>同样，您可以使用<span class="inline2">-=</span>进行减法，使用<span class="inline2">*=</span>进行乘法，使用<span class="inline2">/=</span>除法，或者使用<span class="inline2">|=</span>、<span class="inline2">&amp;=</span>进行按位运算符，或<span class="inline2"><b>^=</b></span>。您还可以使用<span class="inline2"><b>++</b></span>、<span class="inline2"><b>--</b></span>在值中添加或减去<i>一</i>。如需了解更多信息，请参阅<a href="Expressions_And_Operators.htm">表达式和运算符</a>部分。</p><p>请注意，您<i>无法</i>执行以下操作(或任何变更)：</p><p class="code">a = b = c = 4;</p><p>相反，应该按如下方式进行：</p><p class="code">a = 4;<br>b = 4;<br>c = 4;</p><h2>Naming Rules</h2><p>在<b>GML</b>中形成变量时，它们的名称必须以字母或下划线符号<span class="inline2">_</span>开头，并且只能包含字母、数字和下划线符号<span class="inline2">_</span>，最大长度为64 个符号。因此，有效的变量名称为<span class="inline2">fish</span>、<span class="inline2">foo_bar</span>、<span class="inline2">num1</span>或<span class="inline2">_str</span>，而无效的变量名称为<span class="inline2">6fish</span>、<span class="inline2">foo bar</span>，或<span class="inline2">*num</span>。</p><p>You cannot use the names of your assets (e.g. Sprites, Scripts, etc.) for your variables, unless you specify an instance or struct (or keywords like <a href="Variables/Global_Variables.htm"><span class="inline2">global</span></a>,&nbsp;<a href="Instance_Keywords.htm"><span class="inline2">self</span></a>) before such a name, e.g. if you have a script called <span class="inline2">Script1</span>, a variable called <span class="inline2">Script1</span> can be defined as <span class="inline2">self.Script1 = &lt;value&gt;;</span> in an instance or a struct. Doing this explicitly defines the scope of such a variable. For more information, see the section below.</p><h2>变量作用域</h2><p>变量作用域告诉变量属于代码的哪一部分，它由您在代码中首先定义它的位置决定。变量作用域还告诉您可以从代码中的何处访问它。如果需要访问不同作用域中的变量，可以更改作用域。</p><h3>改变范围</h3><p>您可以通过两种方式访问​​不同范围内的变量：</p><ul class="colour"><li>点运算符，例如<span class="inline2">a.b</span>，表示"<span class="inline2">a</span>的变量<span class="inline2">b</span>"。</li><li><a href="Language_Features/with.htm">with</a>语句，例如<span class="inline2">with(a){b = 10;}</span>，表示"执行<span class="inline2">a</span>中的以下代码行"。</li></ul><p>变量<span class="inline2">a</span>可以是实例，也可以是结构体。您还可以使用<a href="Instance_Keywords.htm">实例关键字</a>或<span class="inline2">全局</span>关键字之一。</p><p>有关详细信息，请参阅<a href="Addressing_Variables_In_Other_Instances.htm">在其他实例中寻址变量</a>。</p><h3>范围类型</h3><p>默认情况下，当您在<a href="../../The_Asset_Editors/Object_Properties/Object_Events.htm">对象事件</a>中分配变量时，您会将它们分配给<strong>实例</strong>变量，但当您使用<span data-keyref="GameMaker Name">GameMaker</span>编程时，实际上还有四种其他主要变量类型，每种类型都有自己的{ }范围<strong>。</strong></p><p>以下几页概述了不同类型的变量及其范围：</p><ul class="colour"><li><a href="Variables/Local_Variables.htm">局部变量</a></li><li><a href="Variables/Instance_Variables.htm">实例变量</a></li><li><a href="Variables/Global_Variables.htm">全局变量</a></li><li><a href="Functions/Static_Variables.htm">静态变量</a></li><li><a href="Variables/Constants.htm">常量</a></li></ul><p class="note"><span data-conref="../../assets/snippets/Tag_note.hts"><span class="note">注意</span></span>常量不是"真正的"变量，因为它们会被<a href="../../Introduction/Compiling.htm">编译器</a>替换为其基础值，并且在游戏中不作为变量存在。</p><h2>内置变量</h2><p>GameMaker 语言具有多个不同的内置变量，这些变量可以具有任何上述范围(<i>本地</i>除外)。这些变量很特殊，因为它们默认包含在游戏世界中的对象和房间中。上面提到的部分列出了一些内置全局变量，手册中针对精灵、房间、对象等的不同部分也概述了每种情况下可用的内置变量。</p><p>内置实例变量的示例有：</p><ul class="colour"><li><span class="inline"><a href="../GML_Reference/Asset_Management/Sprites/Sprite_Instance_Variables/sprite_index.htm">sprite_index</a></span> 精灵索引</li><li><a href="../GML_Reference/Asset_Management/Paths/Path_Variables/path_index.htm"><span class="inline">path_scale</span></a> 路径缩放</li><li><a href="../GML_Reference/Asset_Management/Instances/Instance_Variables/speed.htm"><span class="inline">speed</span></a> 速度</li></ul><p>内置全局变量的例子有：</p><ul class="colour"><li><span class="inline"><a href="../GML_Reference/Cameras_And_Display/Cameras_And_Viewports/view_xport.htm">view_xport</a></span> 视口x坐标</li><li><span class="inline"><a href="../GML_Reference/Asset_Management/Instances/instance_count.htm">instance_count</a></span> 实例数量</li><li><span class="inline"><a href="../GML_Reference/Asset_Management/Rooms/room.htm">room</a></span> 房间</li></ul><p>大多数内置变量都可以像其他变量一样进行更改和设置，有些甚至可以是<a href="Arrays.htm">数组(Arrays)</a>，只是你不必像创建常规变量那样设置它们，因为它们已经被初始化为默认值。</p><h2>变量函数</h2><p>最后，还有一些专门用于设置、获取或以某种方式检查变量的函数，可从以下页面获得：</p><ul class="colour"><li><a href="../GML_Reference/Variable_Functions/Variable_Functions.htm">变量函数</a></li></ul><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back: <a href="GML_Overview.htm">GML&nbsp;Overview</a></div><div style="float:right">Next:&nbsp;<a href="Data_Types.htm">数据类型</a></div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></body></html>