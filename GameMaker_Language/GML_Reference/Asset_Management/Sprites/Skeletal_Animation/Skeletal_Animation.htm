<!--?xml version="1.0" encoding="utf-8" ?--><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = "../../../../..";
    gCommonRootRelPath = "../../../../..";
    gTopicId = "8.2.2.3.3.4";
  
//]]></script>

  <script type="text/javascript" src="../../../../../template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/common.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="../../../../../whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="../../../../../template/styles/topic.min.css">
  <link rel="stylesheet" type="text/css" href="../../../../../template/Charcoal_Grey/topicheader.css">
  <meta name="topic-status" content="Draft">

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Skeletal Animation</title>
  <meta name="generator" content="Adobe RoboHelp 2022">
  <link rel="stylesheet" href="../../../../../assets/css/default.css" type="text/css">
  <script src="../../../../../assets/scripts/main_script.js" type="module"></script>
  <meta name="rh-authors" content="Mark Alexander">
  <meta name="topic-comment" content="Page outlining the different Skeletal Animation functions">
  <meta name="rh-index-keywords" content="">
  <meta name="search-keywords" content="Skeletal Animation,gm_SpineTintBlackColour,tint black,Spine">
<meta name="brsnext" value="GameMaker_Language/GML_Reference/Asset_Management/Sprites/Skeletal_Animation/Animation/Animation.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Asset_Management/Sprites/Sprite_Instance_Variables/bbox_top.htm"></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Skeletal Animation">
        <span>Skeletal Animation</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <!--<div class="body-scroll" style="top: 150px;">-->
  <h1>骨骼动画精灵</h1>
  <p>本节中的函数<i>仅</i>用于从骨骼动画文件(特别是<a href="http://es.esotericsoftware.com/"><b>spine</b></a>导出的JSON文件)导入的精灵，并且可用于获取有关游戏中动画资源的信息，以及用于设置动画中的某些属性。这些函数可以与常规Sprite函数和变量一起使用，允许您(例如)使用这些特殊函数混合两个骨骼动画，同时使用普通Sprite实例变量设置图像比例(有关Sprite实例变量的详细信息，请参见此<a href="../Sprite_Instance_Variables/Sprite_Instance_Variables.htm">处的</a>)。</p>
  <p class="note"><span data-conref="../../../../../assets/snippets/Tag_important.hts"><span class="important">重要</span></span>&nbsp;Most of the skeletal sprite functions <strong>do not</strong> take a sprite or instance reference, as they assume the skeletal sprite is assigned to the current instance (via the IDE or by setting the&nbsp;<span class="inline2"><a href="../Sprite_Instance_Variables/sprite_index.htm">sprite_index</a></span>). This means that running such functions under a different context (e.g. a global script, or in a constructor) will result in an error, as the current <span class="inline2"><a href="../../../../GML_Overview/Instance_Keywords.htm">self</a></span>&nbsp;will not have a skeletal sprite in such cases.</p>
  <p class="note"><span class="note">注意</span>有关导入使用Spine制作的骨骼动画精灵的更多信息，请参见<a href="../../../../../Settings/Texture_Information/Non-Bitmap_Sprites.htm">导入非位图精灵</a>一节。</p>
  <p>您可以从以下部分找到有关这些类型的精灵的函数的更多信息：</p>
  <ul class="colour">
    <li><a href="Animation/Animation.htm"><label for="a">动画</label></a></li>
    <li><a href="Skins/Skins.htm"><label for="b">皮肤</label></a></li>
    <li><a href="Attachments/Attachments.htm"><label for="c">附件</label></a></li>
    <li><a href="Bones/Bones.htm"><label for="d">骨骼</label></a></li>
    <li><a href="Slots/Slots.htm"><label for="f">插槽</label></a></li>
    <li><a href="Drawing_And_Miscellaneous/Drawing_And_Miscellaneous.htm"><label for="e">绘制和其他</label></a></li>
  </ul>
  <p>&nbsp;</p>
  <h2>Tint Black 支持</h2>
  <p>此函数允许 Spine 精灵插槽的深色区域以不同于浅色区域的方式着色 (这是 Spine IDE 的一项函数，有关更多详细信息，请参阅 <b>Tint Black</b> 部分 <a href="http://esotericsoftware.com/spine-attachments" target="_blank"> 此处 </a>)。目前，为了在 <span data-keyref="GameMaker Name">GameMaker</span> 中使用此功能，您需要在绘制使用它的 Spine 精灵时使用自定义<a href="../../../../../The_Asset_Editors/Shaders.htm">着色器</a>。该着色器包含一个名为 "<span class="inline">GM_spinetintblackcolour</span>" 的全局统一变量，跑步者用当前的淡黑色填充该变量，该颜色是从脊柱数据中自动检索的。所需的着色器如下所示：</p>
  <p>顶点着色器(与默认的穿过顶点着色器相同)</p>
  <p class="code">attribute vec3 in_Position; // (x,y,z)<br>
    attribute vec4 in_Colour; // (r,g,b,a)<br>
    attribute vec2 in_TextureCoord; // (u,v)<br>
    <br>
    varying vec2 v_vTexcoord;<br>
    varying vec4 v_vColour;<br>
    <br>
    void main()<br>
    {<br>
    &nbsp; &nbsp; vec4 object_space_pos = vec4( in_Position.x, in_Position.y, in_Position.z, 1.0);<br>
    &nbsp; &nbsp; gl_Position = gm_Matrices[MATRIX_WORLD_VIEW_PROJECTION] * object_space_pos;<br>
    &nbsp; &nbsp; v_vColour = in_Colour;<br>
    &nbsp; &nbsp; v_vTexcoord = in_TextureCoord;<br>
    }
  </p>
  <p>片段着色器：</p>
  <p class="code">varying vec2 v_vTexcoord;<br>
    varying vec4 v_vColour;<br>
    <br>
    uniform vec4 gm_SpineTintBlackColour; // This is the uniform containing the tint-black colour<br>
    <br>
    void main()<br>
    {<br>
    &nbsp; &nbsp; vec4 tb = gm_SpineTintBlackColour;<br>
    &nbsp; &nbsp; vec4 texcol = texture2D( gm_BaseTexture, v_vTexcoord );<br>
    &nbsp; &nbsp; vec4 outcol;<br>
    &nbsp; &nbsp; outcol.rgb = v_vColour.rgb * texcol.rgb;<br>
    &nbsp; &nbsp; outcol.rgb += tb.rgb * ((tb.a * (texcol.a - 1.0)) + (1.0 - texcol.rgb)); // This line performs the tint-&nbsp; &nbsp; black blending logic<br>
    &nbsp; &nbsp; outcol.a = v_vColour.a * texcol.a;<br>
    &nbsp; &nbsp; gl_FragColor = outcol;<br>
    }
  </p>
  <p>您可以通过首先调用着色器，然后绘制精灵，然后重置着色器来使用它，如下所示：</p>
  <p class="code">shader_set(shd_spine_tint_black);<br>
    draw_self();<br>
    shader_reset();</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div style="float:left">Back: <a href="../Sprites.htm">精灵</a></div>
        <div style="float:right">Next: <a href="../Sprite_Information/Sprite_Information.htm"><label for="three">Sprite Information</label></a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2023 All Rights Reserved</span></h5>
  </div>
  <!-- KEYWORDS
Spine Sprites
Spine
Skeleton Animation Sprites
gm_SpineTintBlackColour
tint black
-->
  <!-- TAGS
sprite_spìne_functions
-->

</body></html>