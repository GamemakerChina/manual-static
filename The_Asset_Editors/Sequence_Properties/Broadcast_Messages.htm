<!--?xml version="1.0" encoding="utf-8" ?--><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = "../..";
    gCommonRootRelPath = "../..";
    gTopicId = "6.7.0_8";
  
//]]></script>

  <script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="../../template/scripts/common.min.js"></script>
  <script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="../../template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="../../whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
  <link rel="stylesheet" type="text/css" href="../../template/Charcoal_Grey/topicheader.css">
  <meta name="topic-status" content="Draft">

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Broadcast Messages</title>
  <meta name="generator" content="Adobe RoboHelp 2022">
  <link rel="stylesheet" href="../../assets/css/default.css" type="text/css">
  <script src="../../assets/scripts/main_script.js" type="module"></script>
  <meta name="rh-authors" content="Mark Alexander">
  <meta name="topic-comment" content="Page detailing the dope sheet">
  <meta name="rh-index-keywords" content="Sequences - Broadcast Messages">
  <meta name="search-keywords" content="broadcast,messages,broadcast messages">
<meta name="brsnext" value="The_Asset_Editors/Shaders.htm"><meta name="brsprev" value="The_Asset_Editors/Sequence_Properties/Using_Animation_Curves.htm"></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Broadcast Messages">
        <span>Broadcast Messages</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <!--<div class="body-scroll" style="top: 150px;">-->
  <h1>广播消息</h1>
  <p><a href="../Sequences.htm">序列</a>和<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sprites/Sprites.htm">精灵</a>可以在其长度的任何点生成所谓的<strong>广播消息</strong>。这些消息是简单的字符串，添加到动画时间线的特定帧中，当到达时间线中的那个点时，该字符串将广播给所有侦听它的实例。任何具有<a href="../Object_Properties/Other_Events.htm">广播消息事件</a>的实例（在"<strong>其他</strong>"事件类别中找到）将在时间线中到达消息字符串时接收该消息字符串，此时，您需要有一些代码来解析它并做出相应的反应。还要注意，序列也可以侦听广播消息，但这需要您首先使用代码设置侦听器方法（有关详细信息，请参阅GML中的<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">序列事件和时刻</a>一节）。</p>
  <p class="note"><strong><span class="note">注意</span></strong> 将实例的 <strong>image_index</strong> 直接设置为帧将<em>不</em>触发对象精灵的该帧上可能存在的任何广播消息。</p>
  <p>添加广播消息到序列或精灵时间线，只需单击<img alt="Broadcast Message Button Icon" class="icon" src="../../assets/Images/Icons/Icon_Broadcast.png">按钮这一点将打开一个对话框，您可以在其中添加要广播的消息：</p>
  <p class="dropspot"><img alt="Add A broadcast message to a sequence" class="center" src="../../assets/Images/Asset_Editors/Editor_Sequences_Broadcast.gif" style="cursor: nesw-resize;"></p>
  <p>添加后，消息将显示在"关键帧表"（或精灵帧视图）中。要编辑它，您必须单击鼠标右键<img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21">在消息图标上打开与帧重叠的所有消息的列表（一个帧上只能有一条消息，但将多条消息放置在连续帧上会导致它们在视觉上重叠，从而使您更难选择所需的消息，您也可以在同一帧上看到一条消息和一个<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">时刻</a>），然后从列表中选择一个将打开消息对话框，您可以在其中编辑或删除它。</p>
  <p>当触发广播消息事件时，将有一个特殊的<a href="../../GameMaker_Language/GML_Reference/Data_Structures/DS_Maps/DS_Maps.htm">DS映射</a>创建并存储在内置变量<span class="inline">event_data</span>中。此变量ID是一个内置的<em>全局</em>范围变量，但仅在触发它的事件中包含DS映射数据-在这种情况下，广播消息事件将在所有其他时间返回-1。事件将具有的键如下：</p>
  <table>
    <colgroup>
      <col>
      <col>
      <col>
    </colgroup>
    <tbody>
      <tr>
        <th colspan="3"><span data-keyref="Type_Struct_Message_Event"><a target="_blank" href="Broadcast_Messages.htm">消息事件结构</a></span></th>
      </tr>
      <tr>
        <th>变量</th>
        <th>类型</th>
        <th>描述</th>
      </tr>
      <tr>
        <td><span class="inline">event_type</span></td>
        <td><span data-keyref="Type_String"><a target="_blank" href="../../GameMaker_Language/GML_Overview/Data_Types.htm">String</a></span></td>
        <td>对于从序列发送的消息，这将是字符串"<span class="inline">sequence event</span>"，对于从精灵发送的消息则是字符串"<span class="inline">sprite event</span>"。</td>
      </tr>
      <tr>
        <td><span class="inline">message</span></td>
        <td><span data-keyref="Type_String"><a target="_blank" href="../../GameMaker_Language/GML_Overview/Data_Types.htm">String</a></span></td>
        <td>这包含已接收的消息字符串。</td>
      </tr>
      <tr>
        <td><span class="inline">element_id</span></td>
        <td><span data-keyref="Type_ID_Layer_Element"><a target="_blank" href="../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_all_elements.htm">Layer Element ID</a></span></td>
        <td>这包含触发消息的层元素（序列 / 精灵 / 实例）的 ID。然后，您可以使用此 ID 值来确定使用函数 <a href="../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_element_type.htm"><span class="inline">layer_get_element_type()</span></a> 生成消息的元素类型并根据需要使用其他相关功能来瞄准它，或执行诸如播放声音之类的动作。</td>
      </tr>
    </tbody>
  </table>
  <p>注意，实例的广播消息事件将在每次发送广播消息时接收多个字符串。您不需要对所有广播进行操作，并且可以让不同的实例监听不同的广播字符串。但是，您可能有一个实例正在侦听可能同时收到的消息&nbsp;当发生这种情况时，事件将被多次触发-<em>每个消息字符串一次</em>。</p>
  <p>以下是如何检查此事件的简单示例：</p>
  <p class="code">if event_data[? "event_type"] == "sequence event" // or you can check "sprite event"<br>
    {<br>
    &nbsp; &nbsp; switch (event_data[? "message"])<br>
    &nbsp; &nbsp; {<br>
    &nbsp; &nbsp; &nbsp; &nbsp; case "hit":<br>
    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; audio_play_sound(snd_hit, 0, false);<br>
    &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
    <br>
    &nbsp; &nbsp; &nbsp; &nbsp; case "destroy":<br>
    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sequence_destroy(event_data[? "element_id"]);<br>
    &nbsp; &nbsp; &nbsp; &nbsp; break;<br>
    &nbsp; &nbsp; }<br>
    }
  </p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div style="float:left">Back: <a href="../Sequences.htm">序列</a></div>
        <div style="float:right">Next: <a href="The_Sequence_Canvas.htm">序列画布</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5>
  </div>
  <!-- KEYWORDS
Sequences - Broadcast Messages
Broadcast Messages
-->
  <!-- TAGS
sequences_broadcast_messages
-->

</body></html>