<!--?xml version="1.0" encoding="utf-8" ?--><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = "../../../../..";
    gCommonRootRelPath = "../../../../..";
    gTopicId = "8.2.2.3.5.1";
  
//]]></script>

  <script type="text/javascript" src="../../../../../template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/common.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="../../../../../whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="../../../../../template/styles/topic.min.css">
  <link rel="stylesheet" type="text/css" href="../../../../../template/Charcoal_Grey/topicheader.css">
  <meta name="topic-status" content="Draft">

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Audio Emitters</title>
  <meta name="generator" content="Adobe RoboHelp 2022">
  <link rel="stylesheet" href="../../../../../assets/css/default.css" type="text/css">
  <script src="../../../../../assets/scripts/main_script.js" type="module"></script>
  <meta name="rh-authors" content="Mark Alexander">
  <meta name="topic-comment" content="Page outlining the different functions and variables associated with Audio Emitters">
  <meta name="rh-index-keywords" content="">
  <meta name="search-keywords" content="Audio Emitters">
<meta name="brsnext" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Emitters/audio_emitter_create.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/audio_system_is_available.htm"></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Audio Emitters">
        <span>Audio Emitters</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <!--<div class="body-scroll" style="top: 150px;">-->
  <h1><span data-field="title" data-format="default">音频发射器</span></h1>
  <p>提供音频发射器可增强<span data-keyref="GameMaker Name">GameMaker</span>音频引擎的灵活性，并允许您在音频资源中添加实时效果，如音调和多普勒变化，以及将声音定位在3D音频空间内并提供逼真的运动效果。所有这些函数都受<i>收听者</i>在音频环境中的位置影响，因此需要您使用所提供的函数来更改收听者的位置、速度和方向(请参见-<a href="../Audio_Listeners/Audio_Listeners.htm">音频监听器</a>)。</p>
  <h2>使用音频发射器和监听器</h2>
  <p>通过结合音频发射器和收听者，您可以创造一个丰富、活泼的环境。设置此设置可能涉及一些内容，因此在本部分中，我们将讨论如何设置具有发射器和默认侦听器的完整系统。</p>
  <h3>设置衰减模型</h3>
  <p>使用音频发射器(以及使用<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>在与<span data-keyref="Position_Origin">(0， 0， 0)</span>不同的位置播放的声音)时，首先要使用<span class="inline"><a href="../audio_falloff_set_model.htm">audio_falloff_set_model()</a></span>设置衰减模型。 衰减模型确定所播放声音的音量如何随着从收听者到发射器的距离而改变。</p>
  <p>不严格要求您设置此值，但如果不调用此函数，则所使用的模型将是默认的<span class="inline">audio_fa<span class="inline"></span>lloff_none</span>。 这意味着增益设置为 1，因此音量不会随从收听者到发射器的距离而改变。</p>
  <p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">注意</span></span>如果要确保声音不再超过最大距离，则应设置以<span class="inline">_scaled</span>结尾的衰减模型之一。</p>
  <h3>更新侦听器</h3>
  <p>默认音频收听器位于位置<span data-keyref="Position_Origin">( 0， 0， 0)</span>。<a href="../audio_play_sound.htm">audio_play_sound</a>在收听者的位置播放声音。因此，默认情况下，通过左右两个扬声器都能听到以这种方式播放的声音。</p>
  <p>从收听者与声音或发射器的相对位置改变(通过改变收听者或发射器位置)的那一刻起，这种情况将不再存在。</p>
  <p>它不仅具有<strong>位置</strong>，还具有<strong>方向</strong>，可以使用<a href="../Audio_Listeners/audio_listener_orientation.htm">audio_listener_orientation</a>更改该方向。 然而，默认情况下，该方向是颠倒的！默认方向的向上向量设置为<span data-keyref="Unit_Vector_Y">(0， 1， 0)</span>，但由于<span data-keyref="GameMaker Name">GameMaker</span>的y轴指向下，这意味着收听者在房间内倒立。</p>
  <p>您期望在左扬声器中听到的所有声音实际上都会在右扬声器中听到，反之亦然(请参见<a href="../Audio_Listeners/audio_listener_orientation.htm">audio_listener_orientation</a>页的图片了解其外观)。因此，一旦开始移动发射器和接收器，请确保将接收器的方向设置为：</p>
  <p class="code">audio_listener_orientation(0, 0, 1, 0, -1, 0);</p>
  <p>上面的代码行将设置默认侦听器的方向，以便它看起来<strong>进入屏幕</strong>并且<strong>面朝上</strong>。 这相当于听众站在或坐在电脑前看着屏幕。</p>
  <p>当您创建自上而下的游戏时，让听者的方向遵循玩家(或任何其他"听众")所面对的方向可能更有趣。这可以通过以下代码行实现：</p>
  <p class="code">audio_listener_orientation(0, 0, 1, lengthdir_x(1, direction), lengthdir_y(1, direction), 0);</p>
  <p>在这行代码中，不是有一个完全不变的向上向量(y=-1)，而是根据玩家的方向来改变它。最简单的方法是使用<a href="../../../Maths_And_Numbers/Angles_And_Distance/lengthdir_x.htm">lengthdir_x</a>和<a href="../../../Maths_And_Numbers/Angles_And_Distance/lengthdir_y.htm">lengthdir_y</a>函数。观看矢量可以保持不变，因为收听者仍然在查看屏幕。</p>
  <h3>播放声音</h3>
  <p>设置衰减模型并确保正确更新收听者的位置和方向后，可以使用<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>在3D音频空间中开始播放声音：</p>
  <p class="code">sound_instance = audio_play_sound_at(snd_Explosion, x, y, 0, 100, 300, 1, true, 1);</p>
  <p>上面的代码行在<strong>位置(x，y，0)播放声音"snd_Explosion"</strong>，其衰减参考距离为100，衰减最大距离为300，衰减系数为1。</p>
  <p>请注意，您可以更改声音的某些属性，因为它可以通过上面的<span class="inline2">sound_instance</span>变量访问。然而，这些只是声音本身的特性，如增益、偏移和音调。无法更改使用<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>播放的声音的位置或速度。</p>
  <p>总之，<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>是在3D音频空间播放简单声音的好方法，但有限。一旦播放声音，它不允许您更改位置、速度或衰减参数。位置和衰减参数<i>传递给函数，但以后无法更改。</i></p>
  <p>如果你想更好地控制声音的播放方式，请使用音频发射器。</p>
  <h3>添加发射器</h3>
  <p>使用<a href="audio_emitter_create.htm">audio_emitter_create</a>添加音频发射器。 它们位于<span data-keyref="Position_Origin">( 0， 0， 0)</span>，具有 0 的速度和默认衰减设置。</p>
  <p class="code">emitter = audio_emitter_create();</p>
  <h3>更新发射器</h3>
  <p>音频发射器"发出"声音。它可以与现实世界中的扬声器相比较。</p>
  <p>与<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>相比，发射器在开始使用<a href="audio_play_sound_on.htm">audio_play_sound_on</a>播放声音后，其位置、速度、监听器掩码和衰减参数可以更改。</p>
  <p>可以使用<a href="audio_emitter_position.htm">audio_emitter_position</a>更新发射器的位置。 这可以设置为实例的位置：</p>
  <p class="code">audio_emitter_position(emitter, x, y, 0);</p>
  <p>使用<a href="audio_emitter_velocity.htm">audio_emitter_velocity</a>更新发射器的速度。 设置速度的最简单方法是将其设置为实例的<a href="../../Instances/Instance_Variables/hspeed.htm">hspeed</a>和<a href="../../Instances/Instance_Variables/vspeed.htm">vspeed</a>，如下所示：</p>
  <p class="code">audio_emitter_velocity(emitter, hspeed, vspeed, 0);</p>
  <p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">注意</span></span>音频发射器的<i>速度</i>以每步<i>像素表示</i>。<span><span></span></span></p>
  <h3><span data-keyref="GameMaker Name">GameMaker</span>创建的音频发射器</h3>
  <p>当使用<a href="../../Sequences/Sequences.htm">序列</a>时，<span data-keyref="GameMaker Name">GameMaker</span>为序列中的每个音轨(<span><span class="inline2">SeqTrackType_Audio</span>)添加和创建音频发射器。</span>这些发射器的ID可以在<a href="../../Sequences/Sequence_Structs/The_Sequence_Instance_Struct.htm">序列实例的</a><span class="inline2">ActiveTracks[I]中找到。emitterIndex</span>属性。</p>
  <p><span data-keyref="GameMaker Name">GameMaker</span>自动更新此发射器的位置。它不更新音轨发射器的速度，但您可以通过在<a href="audio_emitter_velocity.htm">序列步骤事件</a>之一中调用<a href="../../Sequences/Sequence_Events_Moments_Broadcast.htm">audio_emitter_velocity</a>自行执行此操作。</p>
  <h3>在发射器上播放声音</h3>
  <p>可使用<strong>audio_play_sound_on</strong>在<a href="audio_play_sound_on.htm">发射器上播放</a>声音：</p>
  <p class="code">sound_instance = audio_play_sound_on(emitter,&nbsp;snd_Explosion, false, 10);<br>
    <span></span>
  </p>
  <h3>跟踪播放声音实例</h3>
  <p>每次调用<a href="../audio_play_sound.htm">audio_play_sound</a>、<a href="../audio_play_sound_at.htm">audio_play_sound_at</a>或<a href="audio_play_sound_on.htm">audio_play_sound_on</a>之一时，都会创建一个新的声音<strong>实例</strong>。</p>
  <p>由于各种原因，播放的声音实例可能无法听到，例如其位置离收听者太远。但它始终存在。</p>
  <p>如果要更改声音实例的属性，应为变量指定返回值，如下所示：</p>
  <p class="code">sound_instance = audio_play_sound_at(snd_Explosion, x, y, 0, 100, 300, 1, true, 1);</p>
  <p>在某个时刻，您可能有相当多的声音实例正在播放。在这种情况下，您可以按如下方式将其存储在数组中：</p>
  <p class="code">var _x =&nbsp;random(room_width);<br>
    var _y = random(room_height);<br>
    var _new_sound_instance = audio_play_sound_at(snd_Bird, _x, _y, 0, 200, 400, true, 10);<br>
    array_push(bird_sounds, _new_sound_instance);</p>
  <p>每次执行上述代码时，新创建的声音实例的ID都会添加到<span class="inline2">bird_sounds</span>数组中。</p>
  <p>这样可以跟踪正在播放的所有声音实例(上例中的<span class="inline">snd_Bird</span>)。</p>
  <p class="note"><span data-conref="../../../../../assets/snippets/Tag_important.hts"><span class="important">重要</span></span>声音正在"播放"并不一定意味着收听者将听到该声音。停止播放的声音、离收听者太远的声音、或增益设置过低的声音(或在增益设置过低的发射器上播放的声音)将无法听到。</p>
  <h3>其他侦听器</h3>
  <p>如果要使用其他侦听器，应首先使用<a href="../Audio_Listeners/audio_get_listener_count.htm">audio_get_listener_count</a>检查系统是否支持多个侦听器。</p>
  <p>如果存在多个侦听器，可以使用<a href="../Audio_Listeners/audio_get_listener_info.htm">audio_get_listener_info</a>获取每个监听器的名称、监听器掩码和索引。</p>
  <p>如果您知道侦听器索引，可以使用以<span class="inline">audio_listener_set_</span>而不是<span class="inline">audio_listener_</span>开头的函数来更改其设置(位置、速度和方向)。</p>
  <h2>函数</h2>
  <p>以下函数可用于处理音频发射器：</p>
  <ul class="colour">
    <li><a href="audio_emitter_create.htm">audio_emitter_create</a></li>
    <li><a href="audio_emitter_exists.htm">audio_emitter_exists</a></li>
    <li><a href="audio_emitter_position.htm">audio_emitter_position</a></li>
    <li><a href="audio_emitter_velocity.htm">audio_emitter_velocity</a></li>
    <li><a href="audio_emitter_falloff.htm">audio_emitter_falloff</a></li>
    <li><a href="audio_emitter_gain.htm">audio_emitter_gain</a></li>
    <li><a href="audio_emitter_pitch.htm">audio_emitter_pitch</a></li>
    <li><a href="audio_emitter_set_listener_mask.htm">audio_emitter_set_listener_mask</a></li>
    <li><a href="audio_emitter_free.htm">audio_emitter_free</a></li>
    <li><a href="audio_play_sound_on.htm">audio_play_sound_on</a></li>
    <li><a href="audio_emitter_get_gain.htm">audio_emitter_get_gain</a></li>
    <li><a href="audio_emitter_get_pitch.htm">audio_emitter_get_pitch</a></li>
    <li><a href="audio_emitter_get_x.htm">audio_emitter_get_x</a></li>
    <li><a href="audio_emitter_get_y.htm">audio_emitter_get_y</a></li>
    <li><a href="audio_emitter_get_z.htm">audio_emitter_get_z</a></li>
    <li><a href="audio_emitter_get_vx.htm">audio_emitter_get_vx</a></li>
    <li><a href="audio_emitter_get_vy.htm">audio_emitter_get_vy</a></li>
    <li><a href="audio_emitter_get_vz.htm">audio_emitter_get_vz</a></li>
    <li><a href="audio_emitter_get_listener_mask.htm">audio_emitter_get_listener_mask</a></li>
    <li><a href="audio_emitter_bus.htm">audio_emitter_bus</a></li>
    <li><a href="audio_emitter_get_bus.htm">audio_emitter_get_bus</a></li>
  </ul>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div style="float:left">Back:&nbsp;<a href="../Audio.htm">音频</a></div>
        <div style="float:right">Next:&nbsp;<a href="../Audio_Listeners/Audio_Listeners.htm">音频监听器</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2023 All Rights Reserved</span></h5>
  </div>
  <!-- KEYWORDS
Audio Emitters
-->
  <!-- TAGS
audio_emitter_functions
-->

</body></html>