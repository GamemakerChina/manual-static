<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script type="text/javascript" language="JavaScript">function reDo(){innerWidth==origWidth&&innerHeight==origHeight||location.reload()}4==parseInt(navigator.appVersion)&&"Netscape"==navigator.appName&&(origWidth=innerWidth,origHeight=innerHeight,onresize=reDo),onerror=null</script><style type="text/css">p.WebHelpNavBar{text-align:right}</style><script type="text/javascript">gCommonRootRelPath=gRootRelPath="../..",gTopicId="4.3.2.0_4"</script><script type="text/javascript" src="../../template/scripts/rh.min.js"></script><script type="text/javascript" src="../../template/scripts/common.min.js"></script><script type="text/javascript" src="../../template/scripts/topic.min.js"></script><script type="text/javascript" src="../../template/scripts/topicwidgets.min.js"></script><script type="text/javascript" src="../../whxdata/projectsettings.js"></script><link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css"><link rel="stylesheet" type="text/css" href="../../template/Charcoal_Grey/topicheader.css"><meta name="topic-status" content="Draft"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Reverting Files</title><meta name="generator" content="Adobe RoboHelp 2022"><link rel="stylesheet" href="../../assets/css/default.css" type="text/css"><script src="../../assets/scripts/main_script.js" type="module"></script><meta name="rh-authors" content="Mark Alexander"><meta name="topic-comment" content="Section that covers Source Control reverting files"><meta name="rh-index-keywords" content="Source Control - Reverting Files"><meta name="search-keywords" content="revert files"><meta name="brsnext" value="IDE_Tools/Source_Control/Cloning_A_Repository.htm"><meta name="brsprev" value="IDE_Tools/Source_Control/Standard_Workflow.htm"></head><body><div class="topic-header rh-hide" id="rh-topic-header"><div class="logo"></div><div class="nav"><div class="title" title="Reverting Files"><span>Reverting Files</span></div><div class="gotohome" title="Click here to see this page in full context"><a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a></div></div></div><div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div><h1>回滚文件</h1><p>在前面的小节中，您已经了解了如何<a href="Repository_Options.htm">创建仓库</a>和<a href="Standard_Workflow.htm">向其提交内容</a>，但是如果您犯了一个错误并希望"回滚"到上一次提交，会发生什么呢？让我们犯一个故意的错误，然后看看我们如何处理它。</p><p>首先，创建一个新的资源 -- 在本例中，我们将创建一个脚本资源 -- 最初您将不会看到任何状态图标，因为就源代码管理而言，它还不存在。在脚本资源中添加一行简单的代码，如下所示：</p><p class="code">show_debug_message("Hello World");</p><p>如果现在关闭代码编辑器，脚本将保存，修改后的文件图标<img alt="SCM Modified Icon" class="icon" src="../../assets/Images/Icons/SCM_Modified.png">将显示在<a href="../../Introduction/The_Asset_Browser.htm">资源浏览器</a>中的文件旁边。现在，打开<strong>提交</strong>窗口，您将看到有四个阶段性更改，因为会自动添加新资源：</p><p><img alt="Source Control Staged Changes" class="center" src="../../assets/Images/IDE Tools/SCM_StagedChanges.png">暂存的更改将包括：</p><ul class="colour"><li><span class="inline">.yyp</span> 项目文件</li><li>查看文件</li><li>GML 脚本本身</li><li>引用它的 <span class="inline">.yy</span> 文件</li></ul><p>您应该键入一条提交消息，然后单击<strong>提交</strong>按钮，就像我们前面解释的那样。现在，我们返回到我们的脚本并将代码行更改为(例如)：</p><p class="code">show_debug_message("Hello World, how are you?");</p><p>当我们关闭代码编辑器时，脚本旁边将再次显示一个红色图标<img alt="SCM Modified Icon" class="icon" src="../../assets/Images/Icons/SCM_Modified.png">，但我们已经意识到我们的代码犯了一个错误，我们希望回滚到以前的版本来修复它(显然，您只需打开脚本并轻松修复它，因为示例非常简单，但在大型项目中，这通常不是一个可行的方法)。我们需要做的是<strong>恢复</strong>我们的更改。</p><p>要恢复更改，我们首先需要再次打开提交窗口，因此我们再次转到<strong>源代码管理</strong>&gt;<strong>提交更改</strong>。我们更改的文件将再次暂存以供提交，但这不是我们想要的，因此我们单击按钮<strong>全部取消暂存</strong>将其移出暂存区域。</p><p>如果我们现在在我们更改的文件上右键单击<strong><img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21"></strong>，我们将看到一个上下文菜单，其中包含一个选项以<strong>还原路径</strong>：</p><p><img alt="Source Control Revert Path" class="center" src="../../assets/Images/IDE Tools/SCM_RevertPath.png">当您选择此选项时，您将把文件恢复到它们所处的以前状态。</p><p class="note"><strong>重要！</strong> 当您还原时，您将收到一条消息，要求您重新加载或保存当前项目，因为文件检查器检测到磁盘上的更改：<br><img alt="Source Control Warning" class="center" src="../../assets/Images/IDE Tools/SCM_Warning.png">您必须点击重新加载而不是保存，因为保存将节省内存，而不是重新加载还原的文件。</p><p>当您编辑某些内容并想要在没有执行提交的情况下更改时，这一切都很好，但是当您提交了一个或多个更改并希望回滚到<em>前一个</em>提交时，情况又会怎样呢？好吧，让我们再次编辑我们的脚本，如下所示：</p><p class="code">show_debug_message("This is a bad idea");</p><p>现在，我们像以前一样提交它，以使其处于源代码控制之下。因此，这不是一个好主意，我们想要回滚，这意味着首先我们需要打开<strong>源代码管理</strong>&gt;<strong>查看历史记录</strong>窗口。现在，我们将在此窗口中看到所有先前提交的列表，首先是初始提交、脚本的提交，然后是我们已编辑为"Bad idea"的脚本的提交：</p><p><img alt="Source Control Bad Idea History" class="center" src="../../assets/Images/IDE Tools/SCM_BadIdea.png">我们现在有两个选择。我们可以还原整个修订版本-将更改的所有文件还原为选定提交的文件-或者我们可以选择还原路径-这将简单地还原单个文件。让我们从第一个选项开始：</p><ul class="colour"><li>在<strong>提交历史记录</strong>窗格("Hello World"提交)中，右键单击<strong><img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21"></strong>我们的第二次提交。</li><li>选择<strong>恢复到此修订版本</strong>，然后在警告消息上选择<strong>重新加载</strong>。</li></ul><p>您应该看到该脚本现在有一个红色的状态图标<img alt="SCM Modified Icon" class="icon" src="../../assets/Images/Icons/SCM_Modified.png">，如果我们打开它，我们将看到以下内容：</p><p><img alt="Source Control Revert To Revision" class="center" src="../../assets/Images/IDE Tools/SCM_RevertToRevision.png">然后我们可以在项目上做出提交，我们将再次回到我们所处的位置。但是，我们也可以通过执行以下操作来撤消对该文件操作，并重新提交我们的"bad idea"：</p><ul class="colour"><li>打开<strong>提交更改</strong>窗口。</li><li>取消暂存包含"Hello World"代码的脚本。</li><li>右键单击<strong><img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21"></strong>，然后单击<strong>还原路径</strong>。</li></ul><p>现在，我们又回到了项目中的错误文件！那么，我们可以利用这个机会只恢复该文件路径，而不是将所有内容恢复到以前的版本。为此，我们需要做以下工作：</p><ul class="colour"><li>打开<strong>查看历史记录</strong>窗口。</li><li>点击第二个提交("Hello World"提交)。</li><li>在文件窗格中的脚本 GML 上右键单击<strong><img alt="RMB Icon" class="icon" height="24" src="../../assets/Images/Icons/Icon_RMB.png" width="21"></strong>，然后选择<strong>还原路径</strong>。</li></ul><p>我们应该返回到我们的"Hello World"代码，然后我们可以执行新的提交，以使用更正后的文件再次更新源代码管理。</p><p>&nbsp;</p><p>&nbsp;</p><div class="footer"><div class="buttons"><div class="clear"><div style="float:left">Back: <a href="../Source_Control.htm">源码控制</a></div><div style="float:right">Next: <a href="Cloning_A_Repository.htm">克隆一个仓库</a>&nbsp;</div></div></div><h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5></div></body></html>