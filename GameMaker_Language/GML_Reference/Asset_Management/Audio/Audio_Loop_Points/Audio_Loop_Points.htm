<!--?xml version="1.0" encoding="utf-8" ?--><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = "../../../../..";
    gCommonRootRelPath = "../../../../..";
    gTopicId = "8.2.2.3.5.7";
  
//]]></script>

  <script type="text/javascript" src="../../../../../template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/common.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="../../../../../template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="../../../../../whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="../../../../../template/styles/topic.min.css">
  <link rel="stylesheet" type="text/css" href="../../../../../template/Charcoal_Grey/topicheader.css">
  <meta name="topic-status" content="Draft">
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/default.css"><script src="../../../../../../assets/scripts/main_script.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="generator" content="Adobe RoboHelp 2022">
  <title>Audio Loop Points</title>
  <meta name="topic-status" content="Draft">
  <link rel="stylesheet" type="text/css" href="../../../../../assets/css/default.css">
  <meta name="rh-authors" content="Bart Teunis">
  <meta name="topic-comment" content="Reference page for the audio loop points feature">
  <meta name="template" content="../../../../../assets/masterpages/Manual_Page.htt">
  <meta name="search-keywords" content="audio,loop,loop points">
  <meta name="rh-index-keywords" content="audio loop points">
<meta name="brsnext" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Loop_Points/audio_sound_loop.htm"><meta name="brsprev" value="GameMaker_Language/GML_Reference/Asset_Management/Audio/Audio_Synchronisation/audio_sync_group_is_paused.htm"></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Audio Loop Points">
        <span>Audio Loop Points</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <div>
  </div>
  <div>
  <h1><span data-field="title" data-format="default">音频循环点</span></h1>
  <p><span data-field="title" data-format="default">音频循环点</span>允许您循环音频资源的一部分(或一节)。</p>
  <p>虽然您可以使用 <span class="inline3_func"><a href="../audio_sound_get_track_position.htm">audio_sound_get_track_position</a></span>&nbsp;和 <span class="inline3_func"><a href="../audio_sound_set_track_position.htm">audio_sound_set_track_position</a></span> 手动控制音频播放，但这对于循环一节是永远不会准确的，因为音频的处理速度要高得多，例如每秒 44100 或 48000 次 (采样率)，这比默认的游戏速度 60 要高得多。这意味着在调用一个函数和下一个函数之间可能已经播放了许多样本。</p>
  <p>通过使用为音频循环提供的功能，以音频速率<em>在音频线程</em>上执行循环。</p>
  <p class="note"><span><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">注意</span></span>&nbsp;</span><span>不能将基于缓冲区的音频队列或音频同步组与音频循环功能一起使用。所有其他类型的音频都可以毫无问题地使用，<span>&nbsp;包括<a href="../Audio_Buffers/Audio_Buffers.htm">缓冲声音</a>和<a href="../audio_create_stream.htm">流</a>。</span></span></p>
  <h2>函数指南</h2>
  <p>以下是音频循环的 GML 代码函数：</p>
  <ul class="Disc">
    <li><a href="audio_sound_loop.htm">audio_sound_loop</a></li>
    <li><a href="audio_sound_get_loop.htm">audio_sound_get_loop</a></li>
    <li><a href="audio_sound_loop_start.htm">audio_sound_loop_start</a></li>
    <li><a href="audio_sound_get_loop_start.htm">audio_sound_get_loop_start</a></li>
    <li><a href="audio_sound_loop_end.htm">audio_sound_loop_end</a></li>
    <li><a href="audio_sound_get_loop_end.htm">audio_sound_get_loop_end</a></li>
  </ul>
  <h2>循环部分</h2>
  <p>每个声音资源和声音实例都有一个循环部分，由以秒为单位的开始和结束时间定义。如果声音设置为循环，则此开始和结束之间的声音部分将播放循环。</p>
  <p>使用任何 <span class="inline3_func">audio_play_sound_</span> 函数播放的每个声音都会在播放时从资源获取其默认循环开始时间和循环结束时间，例如：&nbsp;</p>
  <p class="code">audio_sound_loop_start(snd_loop, 2);<br>
    audio_sound_loop_end(snd_loop, 6);<br>
    ins_sound = audio_play_sound(snd_loop, 100, true);<br>
    audio_sound_loop_end(ins_sound, 10);</p>
  <p>默认情况下，声音设置为从头到尾循环。这对应于 0.0 秒的起始值和 0.0 秒的结束值 (对应于 <span class="inline3_func"><a href="../audio_sound_length.htm">audio_sound_length</a></span>)。</p>
  <p>循环结束位置<em>必须</em>在循环开始位置之后，除非它们都设置为 0.0 (即从开始循环到结束声音)。</p>
  <h3>启用/禁用循环</h3>
  <p>设置声音实例的循环状态可以通过两种方式完成。第一个是使用 <span class="inline3_func"><a href="../audio_play_sound.htm">audio_play_sound</a></span> 或任何其他 <span class="inline2">audio_play_sound_</span> 函数播放声音时：</p>
  <p class="code">ins_sound = audio_play_sound(snd_loop, 100, true);</p>
  <p>第二种方式是将函数 <span class="inline3_func"><a href="audio_sound_loop.htm">audio_sound_loop</a></span> 称为已经在播放的声音：</p>
  <p class="code">audio_sound_loop(ins_sound, true);</p>
  <p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">注意</span></span> 当声音的音轨位置到达循环结束位置时，<span data-keyref="GameMaker Name">GameMaker</span> 会检查是否应该循环。如果此时其循环状态设置为 <span class="inline2">true</span>，则声音将跳回循环开始位置。如果不是，它将继续播放声音直到结束，除非您更改轨道位置或循环结束。</p>
  <h2>示例</h2>
  <p>以下是使用音频循环点循环音频的几种方法。</p>
  <h3>前奏和尾声</h3>
  <p>在这种情况下，您有一个音频文件，其中有一个前奏、一个循环的中间部分和一个结尾。音频从头开始播放，首先播放前奏部分，然后移动到循环部分，并继续播放此循环部分，直到音频设置为不再循环。在这一点上，循环部分将完成最后一次播放，然后过渡到超出部分。</p>
  <p class="code">audio_sound_loop_start(snd_music, 10);<br>
    audio_sound_loop_end(snd_music, 20);<br>
    ins_sound = audio_play_sound(snd_music, 100, true);&nbsp; // Play the sound looped</p>
  <p>一旦声音进入循环部分，就可以将声音实例设置为不再循环：</p>
  <p class="code">audio_sound_loop(ins_sound, false);</p>
  <p>更改此设置后，将播放循环部分的其余部分，然后播放尾声部分。</p>
  <p class="note"><span data-conref="../../../../../assets/snippets/Tag_note.hts"><span class="note">注意</span></span> 声音停止播放 <span class="inline2">ins_sound</span> 后，将不再引用有效的声音实例，您需要使用&nbsp;<span class="inline3_func"><a href="../audio_play_sound.htm">audio_play_sound</a></span> 播放新的声音实例。</p>
  <h3>多重循环</h3>
  <p>每个声音都有一个循环部分。您可以自己添加多个循环节，方法是将它们存储在结构中，并在任何给定时刻手动应用要使用的循环节的开始和结束：</p>
  <p class="code">loops = [<br>
    &nbsp; &nbsp; {start: 0, end: 10},<br>
    &nbsp; &nbsp; {start: 10, end: 20},<br>
    &nbsp; &nbsp; {start: 20, end: 30}<br>
    ];<br>
    <br>
    section = 2;<br>
    <br>
    audio_sound_loop_start(snd_several_sections, loops[section].start);<br>
    audio_sound_loop_end(snd_several_sections, loops[section].end);<br>
    ins_sound = audio_play(snd_several_sections, 200, true);
  </p>
  <h3>从 BPM 转换</h3>
  <p>使用一段音乐的 BPM，你可以计算出一个"节拍"所花费的时间。通过这种方式，您可以循环播放与音乐中的节拍或小节精确对应的声音部分：</p>
  <p class="code">var _bpm_to_sec = time_bpm_to_seconds(126);<br>
    var _beats_per_bar = 4;<br>
    var _bars = 4;<br>
    audio_sound_loop_start(snd_bgm, _bars * _beats_per_bars);</p>
  <p>此代码将声音资源 <span class="inline2">snd_bgm</span> 的循环开始位置设置为第五条的开始位置。</p>
  <p>See:&nbsp;</p>
  <ul class="colour">
    <li><a href="../../../Time_Sources/time_bpm_to_seconds.htm">time_bpm_to_seconds</a></li>
    <li><a href="../../../Time_Sources/time_seconds_to_bpm.htm">time_seconds_to_bpm</a></li>
  </ul>
  <h2>限制</h2>
  <ul class="colour">
    <li><span>当将该功能推到其极限时(例如，使用极小的循环部分)，压缩声音将导致性能损失。在这种情况下，最好使用未压缩的声音资源。</span></li>
  </ul>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div>Back:&nbsp;<a href="../Audio.htm">音频</a></div>
        <div>Next:&nbsp;<a href="../Audio_Emitters/Audio_Emitters.htm">音频发射器</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright YoYo Games Ltd. 2024 All Rights Reserved</span></h5>
  </div>

</div>
  <!-- KEYWORDS
-->
  <!-- TAGS
-->

</body></html>